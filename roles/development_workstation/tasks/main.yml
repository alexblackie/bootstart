---

- name: install zsh
  apt:
    name: zsh
    state: present
  when: ansible_facts["distribution"] == "Ubuntu"

- name: install zsh
  dnf:
    name: zsh
    state: present
  when: ansible_facts["distribution"] == "Fedora"

- name: set default shell to zsh
  user:
    shell: /bin/zsh
  when: ansible_facts["os_family"] == "Darwin"

- name: set default shell to zsh
  user:
    shell: /usr/bin/zsh
  when: ansible_facts["os_family"] is not "Darwin"

- name: disable gross vim defaults
  copy:
    dest: /etc/vimrc
    content: ""
  become: yes
  when: ansible_facts["distribution"] == "Fedora"

- name: disable stupid ls colors
  copy:
    dest: /etc/profile.d/colorls.sh
    content: ""
  become: yes
  when: ansible_facts["distribution"] == "Fedora"

- name: Create directory for third-party software sources
  file:
    path: "{{ home }}/src"
    state: directory

- name: Create local bin directory
  file:
    path: "{{ home }}/bin"
    state: directory

- name: Install C toolchain
  become: yes
  dnf:
    name: "@C Development Tools and Libraries"
    state: present
  when: ansible_facts["distribution"] == "Fedora"

- name: Install C toolchain
  become: yes
  apt:
    name: build-essential
    state: present
  when: ansible_facts["distribution"] == "Ubuntu"

- name: Install asdf version manager
  git:
    repo: https://github.com/asdf-vm/asdf.git
    version: v0.6.0
    dest: "{{ home }}/.asdf"
    update: yes

- name: Install some development tools and libraries
  become: yes
  dnf:
    name:
      - ruby-devel
      - automake
      - autoconf
      - wxGTK3-devel
      - wxBase3
      - readline-devel
      - ncurses-devel
      - openssl-devel
      - libyaml-devel
      - libxslt-devel
      - libffi-devel
      - libtool
      - unixODBC-devel
      - git
      - tmux
      - vim
      - the_silver_searcher
      - pwgen
      - optipng
      - nmap
      - ImageMagick
      - ImageMagick-devel
      - sqlite-devel
      - inotify-tools
      - entr
      - jq
      - ShellCheck
    state: present
  when: ansible_facts["distribution"] == "Fedora"

- name: Install some development tools and libraries
  become: yes
  apt:
    name:
      - ruby-dev
      - automake
      - autoconf
      - libwxgtk3.0-dev
      - libgl1-mesa-dev
      - libglu1-mesa-dev
      - libpng-dev
      - libreadline-dev
      - libncurses-dev
      - libssl-dev
      - libyaml-dev
      - libxslt-dev
      - libffi-dev
      - libtool
      - unixodbc-dev
      - git
      - git-doc
      - tmux
      - vim
      - curl
      - silversearcher-ag
      - pwgen
      - optipng
      - nmap
      - imagemagick
      - libmagickwand-dev
      - sqlite3
      - libsqlite3-dev
      - inotify-tools
      - entr
      - whois
      - ethtool
      - jq
      - shellcheck
    state: present
  when: ansible_facts["distribution"] == "Ubuntu"

- name: Install some development tools and libraries
  homebrew:
    name:
      - findutils
      - autoconf
      - wxmac
      - git
      - tmux
      - reattach-to-user-namespace
      - vim
      - curl
      - wget
      - the_silver_searcher
      - pwgen
      - optipng
      - nmap
      - imagemagick
      - sqlite
      - htop
      - jq
      - shellcheck
      - gnupg
    state: present
  when: ansible_facts["os_family"] == "Darwin"

- name: Install system visibility tools
  become: yes
  dnf:
    name:
      - htop
      - perf
      - strace
    state: present
  when: ansible_facts["distribution"] == "Fedora"

- name: Install system visibility tools
  become: yes
  apt:
    name:
      - htop
      - linux-tools-generic
      - dstat
      - strace
    state: present
  when: ansible_facts["distribution"] == "Ubuntu"

- name: Install snapd
  become: yes
  dnf:
    name: snapd
    state: present
  when: ansible_facts["distribution"] == "Fedora"

- name: Install gawk
  become: yes
  apt:
    name: gawk
    state: present
  when: ansible_facts["distribution"] == "Ubuntu"

- name: Ensure we're using gawk
  become: yes
  alternatives:
    name: awk
    path: /usr/bin/gawk
  when: ansible_facts["distribution"] == "Ubuntu"

- import_tasks: postgresql_fedora.yml
  when: ansible_facts["distribution"] == "Fedora"
- import_tasks: postgresql_ubuntu.yml
  when: ansible_facts["distribution"] == "Ubuntu"
- import_tasks: postgresql_macos.yml
  when: ansible_facts["os_family"] == "Darwin"

- import_tasks: redis.yml

- import_tasks: python.yml
- import_tasks: java.yml
- import_tasks: redhat.yml

- import_tasks: cloud_trash.yml
- import_tasks: drone.yml
- import_tasks: fzy.yml
- import_tasks: zod.yml

- import_tasks: dotfiles.yml
