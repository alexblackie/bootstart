---

- name: Install the heroku-cli
  become: yes
  unarchive:
    src: https://cli-assets.heroku.com/branches/stable/heroku-linux-amd64.tar.gz
    dest: /usr/local
    remote_src: yes
    creates: /usr/local/heroku/bin/heroku
  when: ansible_facts["distribution"] == "Fedora" or ansible_facts["distribution"] == "Ubuntu"

- name: Install Terraform
  homebrew:
    name: terraform
    state: present
  when: ansible_facts["os_family"] == "Darwin"

- name: Install Heroku CLI
  homebrew:
    name: heroku/brew/heroku
    state: present
  when: ansible_facts["os_family"] == "Darwin"

- name: Install Terraform
  become: yes
  unarchive:
    src: https://releases.hashicorp.com/terraform/0.11.7/terraform_0.11.7_linux_amd64.zip
    dest: /usr/local/bin
    remote_src: yes
    creates: /usr/local/bin/terraform
  when: ansible_facts["distribution"] == "Fedora" or ansible_facts["distribution"] == "Ubuntu"

- name: Add Heroku CLI to PATH
  become: yes
  copy:
    content: export PATH=/usr/local/heroku/bin:$PATH
    dest: /etc/profile.d/heroku.sh
    mode: 0755
  when: ansible_facts["distribution"] == "Fedora" or ansible_facts["distribution"] == "Ubuntu"

- name: Install Kubernetes tools and CLIs
  homebrew:
    name:
      - kubectl
      - kubernetes-helm
      - kompose
    state: present
  when: ansible_facts["os_family"] == "Darwin"
